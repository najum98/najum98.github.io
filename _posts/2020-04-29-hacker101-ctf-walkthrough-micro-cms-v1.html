---
layout: post
title: "Hacker101 CTF Walkthrough: Micro-CMS v1"
date: "2020-04-29T15:47:00.002+05:00"
author: Najam Ul Saqib
tags:
  - ctf
  - hackerone
  - walkthrough
modified_time: "2021-02-03T13:41:39.644+05:00"
thumbnail: https://1.bp.blogspot.com/-uI-7ZlnVjmI/XqlC2sQXwSI/AAAAAAAAbIg/G4NZp9-lRTYO6p9AlUvHTLj9nYt-tCN6ACLcBGAsYHQ/s72-c/1_SOHrET4hm7C4yqiJVN8rTw.jpeg
blogger_id: tag:blogger.com,1999:blog-1950785263016881513.post-8407047898310176976
blogger_orig_url: https://najum98.blogspot.com/2020/04/hacker101-ctf-walkthrough-micro-cms-v1.html
---

<div dir="ltr" style="text-align: left" trbidi="on">
  <img
    src="https://1.bp.blogspot.com/-uI-7ZlnVjmI/XqlC2sQXwSI/AAAAAAAAbIg/G4NZp9-lRTYO6p9AlUvHTLj9nYt-tCN6ACLcBGAsYHQ/s320/1_SOHrET4hm7C4yqiJVN8rTw.jpeg"
    style="display: none"
  />
  Here is the walkthrough for another CTF available on&nbsp;<a
    href="https://ctf.hacker101.com/ctf"
    target="_blank"
    >Hacker 101</a
  >&nbsp;is <b>Micro-CMS v1</b><br />
  <div class="separator" style="clear: both; text-align: center">
    <a
      href="https://1.bp.blogspot.com/-x9LyqDJaVds/XqlSCPTuYnI/AAAAAAAAbJQ/JSzj2gVfp4s0vsO-xcFLui3DzTvExlk8gCLcBGAsYHQ/s1600/1.PNG"
      style="margin-left: 1em; margin-right: 1em"
      ><img
        border="0"
        data-original-height="51"
        data-original-width="677"
        height="48"
        src="https://1.bp.blogspot.com/-x9LyqDJaVds/XqlSCPTuYnI/AAAAAAAAbJQ/JSzj2gVfp4s0vsO-xcFLui3DzTvExlk8gCLcBGAsYHQ/s640/1.PNG"
        width="640"
    /></a>
  </div>
  This CTF has four flags and I will walk you off through each one of them.
  Let's start!<br /><br />This is the main page of the CTF where you have some
  options like you can create some pages, and read the already created ones.<br />
  <div class="separator" style="clear: both; text-align: center">
    <a
      href="https://1.bp.blogspot.com/-Dfftqi1M5Gk/XqlS21cnfhI/AAAAAAAAbJY/97JSerNAQT0-aW4w9_RDmzReUdVPpTCegCLcBGAsYHQ/s1600/2.PNG"
      style="margin-left: 1em; margin-right: 1em"
      ><img
        border="0"
        data-original-height="160"
        data-original-width="227"
        height="224"
        src="https://1.bp.blogspot.com/-Dfftqi1M5Gk/XqlS21cnfhI/AAAAAAAAbJY/97JSerNAQT0-aW4w9_RDmzReUdVPpTCegCLcBGAsYHQ/s320/2.PNG"
        width="320"
    /></a>
  </div>
  <br /><b>Flag 0:</b><br /><b><br /></b>To find the flag0 you need to first
  create a page with some random content<br />
  <div class="separator" style="clear: both; text-align: center">
    <a
      href="https://1.bp.blogspot.com/-980fKtyXVMs/XqlTgVfvEsI/AAAAAAAAbJg/TBTDFpKB9doHyrg-CIexYo_6NgVB3wmmgCLcBGAsYHQ/s1600/3.PNG"
      style="margin-left: 1em; margin-right: 1em"
      ><img
        border="0"
        data-original-height="387"
        data-original-width="661"
        height="233"
        src="https://1.bp.blogspot.com/-980fKtyXVMs/XqlTgVfvEsI/AAAAAAAAbJg/TBTDFpKB9doHyrg-CIexYo_6NgVB3wmmgCLcBGAsYHQ/s400/3.PNG"
        width="400"
    /></a>
  </div>
  <div class="separator" style="clear: both; text-align: left">
    After creating the page, you will be redirected to the page you just created
    showing the contents. Observe the URL at this moment. It will be something
    like:
  </div>
  <div class="separator" style="clear: both; text-align: center">
    <b>http://34.74.105.127/242d57e34e/page/13</b>
  </div>
  <div class="separator" style="clear: both; text-align: left">
    Noticing that our page number has been assigned number 13 and by manually
    changing the page number you can access other pages.
  </div>
  <div class="separator" style="clear: both; text-align: left">
    Now click on <b>Edit this Page</b>&nbsp;button in the top right corner. Now
    observe the URL which will be like
  </div>
  <div class="separator" style="clear: both; text-align: center">
    <b>http://34.74.105.127/242d57e34e/page/edit/13</b>
  </div>
  <div class="separator" style="clear: both; text-align: left">
    So we know now that we can access a page in two ways, by simply hitting the
    page URL and by hitting the edit page URL. Remember this point!
  </div>
  <div class="separator" style="clear: both; text-align: left"><br /></div>
  <div class="separator" style="clear: both; text-align: left">
    Start playing with the page URL by adding random numbers to it
    e.g&nbsp;http://34.74.105.127/242d57e34e/page/3,&nbsp;http://34.74.105.127/242d57e34e/page/4&nbsp;and
    in doing so you will probably see errors like&nbsp;
  </div>
  <div class="separator" style="clear: both; text-align: center">
    <a
      href="https://1.bp.blogspot.com/-LZcON_vjxz4/XqlZoObjqUI/AAAAAAAAbJ4/xos06_mBKj04_h1s-eI844iH2XdO0j5IgCLcBGAsYHQ/s1600/4.PNG"
      style="margin-left: 1em; margin-right: 1em"
      ><img
        border="0"
        data-original-height="158"
        data-original-width="799"
        height="124"
        src="https://1.bp.blogspot.com/-LZcON_vjxz4/XqlZoObjqUI/AAAAAAAAbJ4/xos06_mBKj04_h1s-eI844iH2XdO0j5IgCLcBGAsYHQ/s640/4.PNG"
        width="640"
    /></a>
  </div>
  <div class="separator" style="clear: both; text-align: left">
    But keep entering different numbers from 1-10 and on page no. 6 you'll
    notice something different.
  </div>
  <div class="separator" style="clear: both; text-align: center">
    <a
      href="https://1.bp.blogspot.com/-SDNPdVSiqv8/XqlZ6aZF4OI/AAAAAAAAbKA/Ucny3p6ZZYwnWEwizSaIsbR0ctAPOM96ACLcBGAsYHQ/s1600/5.PNG"
      style="margin-left: 1em; margin-right: 1em"
      ><img
        border="0"
        data-original-height="139"
        data-original-width="787"
        height="112"
        src="https://1.bp.blogspot.com/-SDNPdVSiqv8/XqlZ6aZF4OI/AAAAAAAAbKA/Ucny3p6ZZYwnWEwizSaIsbR0ctAPOM96ACLcBGAsYHQ/s640/5.PNG"
        width="640"
    /></a>
  </div>
  It's saying that you don't have permission to access this page meaning that
  there exists a page which we can't access by hitting the page URL, do you
  remember the other way to access a page? Right! Try accessing page 6 by
  hitting it in Edit Page URL which will be&nbsp;<b
    >http://34.74.105.127/242d57e34e/page/edit/6</b
  ><br />and here is your flag!<br />
  <div class="separator" style="clear: both; text-align: center">
    <a
      href="https://1.bp.blogspot.com/-Wl7OCWpt29E/XqlasFD0UhI/AAAAAAAAbKM/izZ0oFAX3bMvKJ9Aj5ylYC0W28hJG3MswCLcBGAsYHQ/s1600/fl.PNG"
      style="margin-left: 1em; margin-right: 1em"
      ><img
        border="0"
        data-original-height="360"
        data-original-width="619"
        height="372"
        src="https://1.bp.blogspot.com/-Wl7OCWpt29E/XqlasFD0UhI/AAAAAAAAbKM/izZ0oFAX3bMvKJ9Aj5ylYC0W28hJG3MswCLcBGAsYHQ/s640/fl.PNG"
        width="640"
    /></a>
  </div>
  It's a private page carrying our flag in it.<br /><br /><b>Flag 1:</b
  ><br />This flag is about SQL injection, just hover to any page and click on
  "Edit this page", now add single quotation ( ' ) at the end of the URL
  i.e&nbsp;<b>http://34.74.105.127/242d57e34e/page/edit/13' </b>and you will
  find your flag 1.<br />
  <div class="separator" style="clear: both; text-align: center">
    <a
      href="https://1.bp.blogspot.com/-sprWO1l6tmY/Xql1j6Ce5tI/AAAAAAAAbK0/20nOXOpaOIMwWUqG8danFM8nNcp_2CxiQCLcBGAsYHQ/s1600/f1.PNG"
      style="margin-left: 1em; margin-right: 1em"
      ><img
        border="0"
        data-original-height="30"
        data-original-width="634"
        src="https://1.bp.blogspot.com/-sprWO1l6tmY/Xql1j6Ce5tI/AAAAAAAAbK0/20nOXOpaOIMwWUqG8danFM8nNcp_2CxiQCLcBGAsYHQ/s1600/f1.PNG"
    /></a>
  </div>
  <div class="separator" style="clear: both; text-align: center"></div>
  <br /><br /><b>Flag 2:</b><br /><b><br /></b>For this flag, you need to know
  the concept of Stored XSS, Create a new page but this time don't write some
  random content in there rather add some XSS Payload like
  <b>&lt;script&gt; alert("Stored XSS") &lt;/script&gt; </b>in the Title of the
  page&nbsp;and hit Create, a page will be created as usual. Just move to the
  homepage of the website. Reflected XSS worked! An alert event will occur
  giving you your flag 2.<br />
  <div class="separator" style="clear: both; text-align: center"></div>
  <br />
  <div class="separator" style="clear: both; text-align: center">
    <a
      href="https://1.bp.blogspot.com/-Zm8rkyi7AvM/XqlehgZcTWI/AAAAAAAAbKc/W3ezTcI_ce4JfpOp4pSYk0Suf6iMKhvtwCLcBGAsYHQ/s1600/10.PNG"
      style="margin-left: 1em; margin-right: 1em"
      ><img
        border="0"
        data-original-height="133"
        data-original-width="446"
        height="118"
        src="https://1.bp.blogspot.com/-Zm8rkyi7AvM/XqlehgZcTWI/AAAAAAAAbKc/W3ezTcI_ce4JfpOp4pSYk0Suf6iMKhvtwCLcBGAsYHQ/s400/10.PNG"
        width="400"
    /></a>
  </div>
  <br /><b>Flag 3:</b><br /><b><br /></b>So finally we're on our last flag. This
  flag can be caught using Reflected XSS Payload but requires some in-depth
  analysis of the webpage.<br /><br />As usual, just edit any of the available
  pages, we got our previous flag by writing XSS Payload in the title of the
  page, we forgot about description of the page, but writing&nbsp;<b
    >&lt;script&gt; alert("Stored XSS") &lt;/script&gt; </b
  >straightforward will not work here. The server will sanitize the input and
  your script will not work rather you have to come up with another payload
  which is not detected by the WAF (Web App Firewall) of this website.<br /><br />The
  payload that worked in my case was&nbsp;<b
    >&lt;img src='hello' onerror='alert("xss")'/&gt; </b
  >after writing this off and saving the page. A pop up will appear stating that
  your script worked<br />
  <div class="separator" style="clear: both; text-align: center">
    <a
      href="https://1.bp.blogspot.com/-XgbpXWxHb3U/Xql4IemsHmI/AAAAAAAAbLA/C6_JHfUPy08ReoqCD3GWN3KAtnbF_aOvACLcBGAsYHQ/s1600/xss.PNG"
      style="margin-left: 1em; margin-right: 1em"
      ><img
        border="0"
        data-original-height="130"
        data-original-width="448"
        height="115"
        src="https://1.bp.blogspot.com/-XgbpXWxHb3U/Xql4IemsHmI/AAAAAAAAbLA/C6_JHfUPy08ReoqCD3GWN3KAtnbF_aOvACLcBGAsYHQ/s400/xss.PNG"
        width="400"
    /></a>
  </div>
  <br />But this does not include a flag, don't worry just view the page source
  and you will find your flag :) This shows that how in-depth analysis you need
  to make to succeed in web app pen-testing.<br />
  <div class="separator" style="clear: both; text-align: center">
    <a
      href="https://1.bp.blogspot.com/-P_IggZzJlHE/Xql4nTgf_sI/AAAAAAAAbLI/gUQVBGS5xAoU5vsxzjvNwhsZHazV_gyDgCLcBGAsYHQ/s1600/ff.PNG"
      style="margin-left: 1em; margin-right: 1em"
      ><img
        border="0"
        data-original-height="83"
        data-original-width="980"
        src="https://1.bp.blogspot.com/-P_IggZzJlHE/Xql4nTgf_sI/AAAAAAAAbLI/gUQVBGS5xAoU5vsxzjvNwhsZHazV_gyDgCLcBGAsYHQ/s1600/ff.PNG"
    /></a>
  </div>
  <br />
</div>
